<form
  id="rightForm"
  (ngSubmit)="rightForm.form.valid && saveAndClose()"
  #rightForm="ngForm"
  class="flex flex-col max-w-310 md:min-w-310 overflow-hidden max-h-screen -m-6"
>
  <!-- Header -->
  <div
    class="flex flex-0 items-center justify-between h-12 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-primary text-on-primary"
  >
    <div class="text-lg font-medium head-modal">
      <span>Chi tiết đào tạo ngắn hạn</span>
    </div>
    <button mat-icon-button [tabIndex]="-1" (click)="close()">
      <i class="fa-light fa-xmark icon-size-5"></i>
    </button>
  </div>

  <div
    #mainns
    class="flex flex-col flex-auto h-modal max-h-128 overflow-y-auto"
  >
    <div
      class="grid grid-cols-1 sm:grid-cols-2 gap-y-3 gap-x-8 w-full min-w-0 p-6 overflow-y-auto"
    >
      <div class="flex items-center sm:col-span-2">
        <mat-form-field appearance="fill" class="w-full -pl-2">
          <mat-label class="sm:w-1/4 leading-none -mr-1"
            >Nơi đào tạo, cấp CC</mat-label
          >
          <input
            matInput
            [readonly]="stateForm"
            placeholder=""
            name="noidaotao"
            [(ngModel)]="data.noidaotao"
          />
        </mat-form-field>
      </div>
      <div class="flex items-center sm:col-span-2">
        <mat-form-field appearance="fill" class="w-full -pl-2">
          <mat-label class="sm:w-1/4 leading-none -mr-1"
            >Nội dung đào tạo
          </mat-label>
          <input
            matInput
            [readonly]="stateForm"
            placeholder=""
            name="ngayxuatngu"
            [(ngModel)]="data.noidungdt"
            required
          />
        </mat-form-field>
      </div>
      <div class="flex flex-col justify-center">
        <div class="mb-1">
          <p-checkbox
            class="mr-2"
            name="groupname"
            [binary]="true"
            inputId="ngoaingu"
            [disabled]="stateForm"
            [(ngModel)]="data.dtngoaingu"
            (onChange)="changeNNgu()"
          ></p-checkbox>
          <label
            style="line-height: normal"
            class="mat-field-label"
            for="ngoaingu"
            >Ngoại ngữ</label
          >
        </div>
        <p-dropdown
          [disabled]="stateForm || !data?.dtngoaingu"
          panelStyleClass="max-w-full"
          [style]="{ width: '100%' }"
          [options]="listNNgu"
          optionLabel="name"
          optionValue="id"
          name="ngoaingu"
          placeholder="&nbsp;"
          appendTo="body"
          [(ngModel)]="data.lNgoainguId"
          [filter]="true"
          filterBy="name"
          (onChange)="onChangeNgoaiNgu($event.value)"
        >
        </p-dropdown>
      </div>
      <div class="flex flex-col justify-center">
        <div class="mat-field-label">CC ngoại ngữ</div>
        <p-dropdown
          [disabled]="stateForm || !data?.dtngoaingu"
          placeholder="&nbsp;"
          panelStyleClass="max-w-full"
          [(ngModel)]="data.lTrinhdonnId"
          [style]="{ width: '100%' }"
          [options]="listCCNNgu"
          optionLabel="name"
          optionValue="id"
          name="nganhang"
          appendTo="body"
          [filter]="true"
          filterBy="name"
          (onChange)="onChangeCCNN($event.value)"
        >
        </p-dropdown>
      </div>
      <div class="flex items-center">
        <mat-form-field class="fuse-mat-no-subscript w-full">
          <mat-label class="">Thời gian từ ngày</mat-label>
          <input
            matInput
            [readonly]="stateForm"
            [matDatepicker]="tungay"
            name="tungay"
            [(ngModel)]="data.ngaybd"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="tungay"
          ></mat-datepicker-toggle>
          <mat-datepicker #tungay [disabled]="stateForm"></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="flex items-center">
        <mat-form-field class="fuse-mat-no-subscript w-full">
          <mat-label class="">Đến ngày</mat-label>
          <input
            matInput
            [readonly]="stateForm"
            [matDatepicker]="denngay"
            name="denngay"
            [min]="data?.ngaybd"
            [(ngModel)]="data.ngaykt"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="denngay"
          ></mat-datepicker-toggle>
          <mat-datepicker #denngay [disabled]="stateForm"></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="flex items-center sm:col-span-2">
        <mat-form-field appearance="fill" class="w-full -pl-2">
          <mat-label class="sm:w-1/4 leading-none -mr-1"
            >Chứng chỉ số</mat-label
          >
          <input
            matInput
            [readonly]="stateForm"
            placeholder=""
            name="chungchi"
            [(ngModel)]="data.chungchiSo"
          />
        </mat-form-field>
      </div>
      <div class="flex items-center">
        <mat-form-field class="fuse-mat-no-subscript w-full">
          <mat-label class="">Ngày cấp CC</mat-label>
          <input
            matInput
            [readonly]="stateForm"
            [matDatepicker]="ngaycap"
            name="ngaycap"
            [(ngModel)]="data.chungchiNgaycap"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="ngaycap"
          ></mat-datepicker-toggle>
          <mat-datepicker #ngaycap [disabled]="stateForm"></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="flex items-center">
        <mat-form-field class="fuse-mat-no-subscript w-full">
          <mat-label class="">Ngày hết hạn</mat-label>
          <input
            matInput
            [readonly]="stateForm"
            [matDatepicker]="ngayhh"
            name="ngayhh"
            [min]="data?.chungchiNgaycap"
            [(ngModel)]="data.chungchiNgayhh"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="ngayhh"
          ></mat-datepicker-toggle>
          <mat-datepicker #ngayhh [disabled]="stateForm"></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="flex flex-col justify-center sm:col-span-2">
        <div class="mat-field-label">Chứng chỉ đính kèm</div>
        <!-- <p-fileUpload #fileForm accept="image/*,.doc,.docx,.pdf,.xls,.xlsx" class="w-full text-base"
                    chooseLabel="Chọn" multiple="multiple" cancelLabel="Hủy" [customUpload]="true" maxFileSize="102400000"
                    (onSelect)="myUploader($event, fileForm)">
                </p-fileUpload> -->
        <p-fileUpload
          #fileForm
          accept="image/*,.doc,.docx,.pdf,.xls,.xlsx"
          class="w-full text-base"
          chooseLabel="Chọn"
          cancelLabel="Hủy"
          [customUpload]="true"
          (onClear)="removeAllFiles($event)"
          [maxFileSize]="102400000"
          (onSelect)="myUploader($event, fileForm)"
          [disabled]="stateForm"
        >
          <ng-template pTemplate="content">
            <ul *ngIf="data.fileList">
              <div *ngFor="let file of data.fileList">
                <div
                  *ngIf="!file.deleted"
                  class="flex items-center justify-between w-full md:w-auto mt-2"
                >
                  <div class="fuse-mat-no-subscript w-2/5">
                    <div class="mat-field-label truncate">
                      {{ file.fileName }}
                    </div>
                  </div>

                  <div class="fuse-mat-no-subscript w-1/5">
                    <div class="mat-field-label">{{ file.fileSize }} bytes</div>
                  </div>

                  <div class="flex justify-end w-1/5">
                    <!-- <p-button icon="pi pi-times" (click)></p-button> -->
                    <button
                      pButton
                      icon="fa-light fa-trash-can"
                      type="button"
                      (click)="deleteFile(file)"
                      [disabled]="stateForm"
                    ></button>
                  </div>
                </div>
              </div>
            </ul>
          </ng-template>
          <ng-template let-file pTemplate="file">
            <div
              class="flex items-center justify-between w-full md:w-auto mt-2"
            >
              <div class="fuse-mat-no-subscript w-2/5">
                <div class="mat-field-label truncate">{{ file.name }}</div>
              </div>

              <div class="fuse-mat-no-subscript w-1/5">
                <div class="mat-field-label">{{ file.size }} bytes</div>
              </div>

              <div class="flex justify-end w-1/5">
                <!-- <p-button icon="pi pi-times" (click)></p-button> -->
                <button
                  pButton
                  icon="pi pi-times"
                  type="button"
                  (click)="removeFile(file, fileForm, $event)"
                ></button>
              </div>
            </div>
          </ng-template>
        </p-fileUpload>
      </div>
    </div>
  </div>

  <div
    class="flex flex-0 items-center justify-end h-12 mr-2 pr-3 sm:pr-5 pl-6 sm:pl-8 mt-2 text-on-primary"
  >
    <div mat-dialog-actions class="h-toolbar flex justify-end">
      <button
        type="submit"
        class="mx-1 button-green"
        [disabled]="stateForm"
        mat-flat-button
      >
        <i class="fa-light fa-check icon-size-5"></i>
        <span class="ml-2">Lưu</span>
      </button>
    </div>
  </div>
</form>
